function H = GetCoefficientMatrix(P,Q)
[m,n] = size(P);
A= zeros(3* n, 16);
tic
for i = 1:n      
        X0 = P(1:3,i);
        X1 = Q(1:3,i);
        
        A((i-1)*3+1, 1) = -X0(1);
        A((i-1)*3+1, 2) = -X0(2);
        A((i-1)*3+1, 3) = -X0(3);
        A((i-1)*3+1, 4) = -1;
        A((i-1)*3+1, 5) = 0;
        A((i-1)*3+1, 6) = 0;
        A((i-1)*3+1, 7) = 0;
        A((i-1)*3+1, 8) = 0;
        A((i-1)*3+1, 9) = 0;
        A((i-1)*3+1, 10) = 0;
        A((i-1)*3+1, 11) = 0;
        A((i-1)*3+1, 12) = 0;
        A((i-1)*3+1, 13) = X1(1) * X0(1);
        A((i-1)*3+1, 14) = X1(1) * X0(2);
        A((i-1)*3+1, 15) = X1(1) * X0(3);
        A((i-1)*3+1, 16) = X1(1);
        
        A((i-1)*3+2, 1) = 0;
        A((i-1)*3+2, 2) = 0;
        A((i-1)*3+2, 3) = 0;
        A((i-1)*3+2, 4) = 0;
        A((i-1)*3+2, 5) = -X0(1);
        A((i-1)*3+2, 6) = -X0(2);
        A((i-1)*3+2, 7) = -X0(3);
        A((i-1)*3+2, 8) = -1;
        A((i-1)*3+2, 9) = 0;
        A((i-1)*3+2, 10) = 0;
        A((i-1)*3+2, 11) = 0;
        A((i-1)*3+2, 12) = 0;
        A((i-1)*3+2, 13) = X1(2) * X0(1);
        A((i-1)*3+2, 14) = X1(2) * X0(2);
        A((i-1)*3+2, 15) = X1(2) * X0(3);
        A((i-1)*3+2, 16) = X1(2);
        
        A((i-1)*3+3, 1) = 0;
        A((i-1)*3+3, 2) = 0;
        A((i-1)*3+3, 3) = 0;
        A((i-1)*3+3, 4) = 0;
        A((i-1)*3+3, 5) = 0;
        A((i-1)*3+3, 6) = 0;
        A((i-1)*3+3, 7) = 0;
        A((i-1)*3+3, 8) = 0;
        A((i-1)*3+3, 9) = -X0(1);
        A((i-1)*3+3, 10) = -X0(2);
        A((i-1)*3+3, 11) = -X0(3);
        A((i-1)*3+3, 12) = -1;
        A((i-1)*3+3, 13) = X1(3) * X0(1);
        A((i-1)*3+3, 14) = X1(3) * X0(2);
        A((i-1)*3+3, 15) = X1(3) * X0(3);
        A((i-1)*3+3, 16) = X1(3);
end

[U,S,V] = svd(A);
[r,c] = size(V);
h = V(:,c);
toc
h = h / norm(h);
save('h.mat','h');
HT= reshape(h, 4,4);
H = HT';

